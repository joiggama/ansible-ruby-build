language: python
python: '2.7'
before_install:
- sudo apt-get update -qq
- pip install --upgrade pip
install:
- pip install ansible
- mv test/ansible.cfg.example ansible.cfg
script:
- ansible-playbook -i test/inventory test/travis.yml --syntax-check
- ansible-playbook -i test/inventory test/travis.yml --connection=local --sudo
- >
  ansible-playbook -i test/inventory test/travis.yml --connection=local --sudo
  | grep -q "changed=1.*failed=0"
  && (echo 'Idempotence test: pass' && exit 0)
  || (echo 'Idempotence test: fail' && exit 1)
notifications:
  webhooks:
    urls:
      secure: FHSQaT0cX/6hk+Yg863kg4BgoL44P0m9C7TtlGBO5VRLfnQ1sZtpOlTRWgyjaFThJRJR3BRI4wIIxDa+fln0s9imq/VnAtDQQVjTD1aIxdM8kMPwelghXhuv380woPHFTFKoaV0Lua/gK0elCRbaCEYKsZGcKQoyWzPpy5wB+1E=
